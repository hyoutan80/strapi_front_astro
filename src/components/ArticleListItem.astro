---
import { format } from "date-fns";
import type { Article } from "../types";
import { cn } from "../lib/utils";

interface Props {
  article: Article;
  className?: string;
}

const { article, className } = Astro.props;
const articleData = article.attributes || article;
const { title, slug, publishedAt, category, display_date } = articleData;
const displayDate = display_date || publishedAt;

const categoryData = category as any;
const categoryName = categoryData?.name || categoryData?.data?.attributes?.name || categoryData?.data?.name || "Uncategorized";
---

<a
  href={`/article/${slug}`}
  class={cn(
    "group flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 py-4 border-b border-border/40 hover:bg-muted/30 transition-colors px-2 rounded-lg",
    className
  )}
>
  <div class="flex items-center gap-3 shrink-0">
    <span class="text-xs text-muted-foreground font-mono">
      {displayDate ? format(new Date(displayDate), "yyyy/MM/dd") : ""}
    </span>
  </div>
  
  <h3 class="font-medium text-sm sm:text-base group-hover:text-primary transition-colors line-clamp-1 sm:line-clamp-1 flex-1">
    {title}
  </h3>

  <div class="shrink-0 mt-1 sm:mt-0">
     <span class="inline-flex items-center rounded-full border border-border bg-secondary/50 px-2.5 py-0.5 text-xs font-semibold text-foreground/80">
        {categoryName}
     </span>
  </div>
</a>
